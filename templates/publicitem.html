{% extends "main.html" %}
{% block title %}Item page {% endblock %}
{% block script %}


<script>
  // Event trigger when DOM of the page is fully parsed by the browser.
  // This is jQuery function $()
  $('document').ready(function() {
    // Some code to be executed...
    // Event handlers for the buttons that are in the page...
    $('#getContent').click(getContent);
    $('#loadHTML').click(loadHTML);
  });
  // We use the keyword fucntion to call a js method.
  function getContent() {
    // Using the jQuery object $ and calling the global ajax function
    // which takes in a few arguements - the first is the content
    // we want to get.
    $.ajax({
            // The url of the resource want to get
            url: '/catalog/<category_name>/<item_title>/',
            type: 'GET',
            // setContent is the function to be called on success.
            success: setContent,
            //The datatype i am expecting from the server.
            datatype: "JSON"
          });
        }
        // getContent takes in three arguments: data, status and jqxhr
        function getContent(data,  status, jqxhr) {
          // #cart is the page where results will be loaded.
          $('#cart').json(data);
        }

        function loadHTML() {
          // The load function handles everything from retreiving
          // the data to loading it into the new element #checkout
          $('#Checkout').load('/catalog/<category_name>/<item_title>/');
        }

</script>


{% endblock %}
{% block content %}
{% include "header.html" %}

<!--TODO <script> to send arguement to addToCart -->

<div class = 'flash'>
        {% with messages = get_flashed_messages() %}
    {% if messages %}

      <ul>
      {% for message in messages %}
          <li> <strong> {{ message }} </strong> </li>
      {% endfor %}
      </ul>
      {% endif %}
  {% endwith %}

</div>

<div class="row main padding-top padding-bottom">
  <div class="col-md-1"></div>
  <div class="col-md-10 padding-top padding-bottom">
      <div class="item">
        <h2 class="title text-dark text-black"><strong>{{ item.title }}</strong></h2>
        <p>{{item.description}}</p>
        <p class="price">{{item.price}}</p>
        <div id="selling">
          <div class="button padding-top, padding-bottom col-md-2">
            <a class="text-warning" id="loadHTML" href="{{url_for('showItem', category_name = category_name, item_title = item_title) }}">Buy Now</a>
          </div>
          <div class="vl"></div>
          <div class="col-md-2">
            <a class="text-warning" id="getContent" type="button"     href="{{url_for('addItemToCart', item_title = item_title)}}">Add to Basket
            </a>
          </div>
        </div>
      </div>

  </div>
  <div class="col-md-1"></div>
</div>


{% endblock %}
