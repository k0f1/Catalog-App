{% extends "main.html" %}
{% block title %} Product {% endblock title %}
{% block content %}
{% include "header.html" %}

<!--TODO <script> to send arguement to addToCart -->

<div class = 'flash'>
        {% with messages = get_flashed_messages() %}
    {% if messages %}

      <ul>
      {% for message in messages %}
          <li> <strong> {{ message }} </strong> </li>
      {% endfor %}
      </ul>
      {% endif %}
  {% endwith %}

</div>

<div class="row main padding-top padding-bottom">
  <div class="col-md-1"></div>
  <div class="col-md-10 padding-top padding-bottom">


      <div class="item" id="product">

        <div class="product-item">
          <h2 class="title text-dark text-black"><strong>{{ item.title }}</strong></h2>
          <p>{{item.description}}</p>
          <p class="price">{{item.price}}</p>
        </div><!--Product information-->
        <div id="selling">
          <div class="button padding-top, padding-bottom col-md-2">
            <a class="text-warning" id="{{item.item_title}}" href="{{url_for('showItem', category_name = category_name, item_title = item_title) }}">Buy Now</a>
          </div><!--Buy Now Button-->
          <div class="vl"></div><!-- Vertical Line-->
          <div class="col-md-2">
            <a class="text-warning" id="{{item.title}}" type="button"     href="{{url_for('addItemToCart', item_title = item_title)}}">Add to Basket
            </a>
          </div><!--Add To Basket Button-->
        </div><!-- Selling-->
      </div> <!--Product-->
  </div>
  <div class="col-md-1"></div>
</div>

{% block script %}
<script>
  // Event trigger when DOM of the page is fully parsed by the browser.
  // This is jQuery function $()
  $('document').ready(function() {
    // Some code to be executed...
    // Event handlers for the buttons that are in the page...
    //$('#getContent').click(getContent);
    $('#{{item.title}}').on('click dblclick', addToBasket);
    $('#{{item.title}}').on('click dblclick', buyNow);
    getData();
  });
  // We use the keyword fucntion to call a js method.
  function getData() {
    // By using the jQuery object $ and calling the global ajax function
    // which takes in a few arguements - the first is the content
    // we want to get.
    $.ajax({
            // To make a request to a server and get a response back.
            // Parse in an object with a set of properties.
            // the first property is the url of the data we want to retreive.
            url: '/catalog/cart/<item_title>/add',
            type: 'GET',

            //The datatype is the type od data I want to get back
            dataType: {},
            // This is the function to be called when things succeed or fail.
            success: successFn,
            error: errorFn,
            complete: function(xhr, status) {
              console.log("The request is complete");
            })// End of ajax
      } // End of getData function
      function successFn(result) {
          console.log("Setting result");
          window.location.href = '/catalog/cart';
        }

        function errorFn(xhr, status, strErr) {
          console.log("There was an error!");
        }

</script>
{% endblock %}


{% endblock %}
